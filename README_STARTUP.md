# WebPMS 一键启动指南

## 简介

WebPMS一键启动脚本用于简化开发环境的启动过程，自动完成以下任务：

1. 检查并管理端口占用
2. 根据实际端口更新Nginx配置
3. 按顺序启动所有服务：Redis、后端、前端、Nginx
4. 提供服务状态和访问信息

## 使用方法

### 一键启动

双击运行 `start-webpms.bat` 脚本即可一键启动所有服务。脚本会自动执行以下步骤：

1. 检查必要组件是否存在
2. 读取端口配置（.env.ports）
3. 检查端口占用情况
4. 根据需要调整或释放端口
5. 更新Nginx配置
6. 按顺序启动所有服务

### 停止服务

要停止所有WebPMS服务，请运行 `stop-webpms.bat` 脚本，它会自动停止：

1. Nginx服务
2. 前端服务（Vue）
3. 后端服务（Django）
4. Redis服务

## 端口配置

WebPMS使用以下默认端口：

- 前端服务：9527
- 后端服务：9803
- Redis服务：6379
- Nginx代理：8754（对外访问端口）

如需修改端口配置，请编辑项目根目录下的 `.env.ports` 文件。

## 常见问题

### 端口被占用

启动脚本会自动检测端口占用并提供选项：
- 可以选择终止占用端口的进程
- 或者取消启动，手动修改端口配置

### Nginx配置问题

如果Nginx启动失败，请检查：
1. 配置文件是否有语法错误
2. 日志文件: `nginx-1.26.3/logs/error.log`

### 服务启动失败

如果任一服务启动失败，请查看相应服务的控制台窗口获取错误信息。

## 高级用法

### 自定义端口池

可以在`.env.ports`文件中定义前端和后端服务的可用端口池：
```
# 可用的前端端口池(用空格分隔)
FRONTEND_PORT_POOL="9527 9528 9529 9530 9531 9532 9533 9534 9535"

# 可用的后端端口池(用空格分隔)
BACKEND_PORT_POOL="9703 9704 9705 9706 9707 9708 9709 9710 9711"
```

### 自动端口切换

如果启用了自动端口切换功能，系统会在默认端口被占用时，自动从端口池中选择可用端口：
```
# 是否允许自动切换端口(0=禁用, 1=启用)
AUTO_PORT_SWITCH=1
```

## 技术支持

如遇问题，请参考项目文档或联系开发团队。 